{"version":3,"file":"index.umd.js","sources":["../src/index.ts"],"sourcesContent":["import { readFileSync, writeFileSync } from 'fs';\nimport * as path from 'path';\nimport { exec } from 'child_process';\n\nconst execPromise = (command) => {\n  return new Promise((resolve, reject) => {\n    exec(command, (error, stdout, stderr) => {\n      if (error) {\n        reject({ error, stderr, stdout });\n      } else {\n        resolve(stdout);\n      }\n    });\n  });\n};\n\nexport const meteorPackageTypesGenerator = {\n  run: async ({\n    tsInput,\n    declarationInput,\n    declarationOutput,\n    prefix,\n    tscCliParams = '--emitDeclarationOnly --declaration --declarationMap',\n  }) => {\n    try {\n      await execPromise(\n        `npx tsc ${tsInput.join(\n          ' '\n        )} --outFile ${declarationInput} ${tscCliParams}`\n      );\n    } catch (error) {\n      console.log(error?.stderr);\n      console.log(error?.stdout);\n      console.error(error?.error);\n    }\n\n    // Read the contents of the generated .d.ts file\n    const fileContent = readFileSync(declarationInput, 'utf-8');\n\n    // Add prefix to each module declaration\n    const updatedContent = fileContent\n      .replace(/declare module [\"'](.+?)[\"']/g, (match, p1) => {\n        return `declare module \"${prefix}${p1}\"`;\n      })\n      .replace(/\\/index/g, '');\n\n    // Write the updated content to a new file or overwrite the existing file\n    writeFileSync(declarationOutput, updatedContent, 'utf-8');\n\n    console.log(\n      `Prefixes added to modules and written to ${declarationOutput}`\n    );\n  },\n};\n"],"names":["execPromise","command","Promise","resolve","reject","exec","error","stdout","stderr","meteorPackageTypesGenerator","run","tsInput","declarationInput","declarationOutput","prefix","tscCliParams","join","console","log","fileContent","readFileSync","updatedContent","replace","match","p1","writeFileSync"],"mappings":";;;;;EAIA,MAAMA,WAAW,GAAIC,OAAO,IAAI;EAC9B,EAAA,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrCC,kBAAI,CAACJ,OAAO,EAAE,CAACK,KAAK,EAAEC,MAAM,EAAEC,MAAM,KAAI;EACtC,MAAA,IAAIF,KAAK,EAAE;EACTF,QAAAA,MAAM,CAAC;YAAEE,KAAK;YAAEE,MAAM;EAAED,UAAAA,MAAAA;EAAQ,SAAA,CAAC,CAAA;EAClC,OAAA,MAAM;UACLJ,OAAO,CAACI,MAAM,CAAC,CAAA;EAChB,OAAA;EACH,KAAC,CAAC,CAAA;EACJ,GAAC,CAAC,CAAA;EACJ,CAAC,CAAA;AAEM,QAAME,2BAA2B,GAAG;IACzCC,GAAG,EAAE,OAAO;MACVC,OAAO;MACPC,gBAAgB;MAChBC,iBAAiB;MACjBC,MAAM;EACNC,IAAAA,YAAY,GAAG,sDAAA;EAAsD,GACtE,KAAI;MACH,IAAI;EACF,MAAA,MAAMf,WAAW,CACf,CAAWW,QAAAA,EAAAA,OAAO,CAACK,IAAI,CACrB,GAAG,CACJ,CAAcJ,WAAAA,EAAAA,gBAAgB,CAAIG,CAAAA,EAAAA,YAAY,EAAE,CAClD,CAAA;OACF,CAAC,OAAOT,KAAK,EAAE;QACdW,OAAO,CAACC,GAAG,CAACZ,KAAK,oBAALA,KAAK,CAAEE,MAAM,CAAC,CAAA;QAC1BS,OAAO,CAACC,GAAG,CAACZ,KAAK,oBAALA,KAAK,CAAEC,MAAM,CAAC,CAAA;QAC1BU,OAAO,CAACX,KAAK,CAACA,KAAK,oBAALA,KAAK,CAAEA,KAAK,CAAC,CAAA;EAC5B,KAAA;EAED;EACA,IAAA,MAAMa,WAAW,GAAGC,eAAY,CAACR,gBAAgB,EAAE,OAAO,CAAC,CAAA;EAE3D;EACA,IAAA,MAAMS,cAAc,GAAGF,WAAW,CAC/BG,OAAO,CAAC,+BAA+B,EAAE,CAACC,KAAK,EAAEC,EAAE,KAAI;EACtD,MAAA,OAAO,CAAmBV,gBAAAA,EAAAA,MAAM,CAAGU,EAAAA,EAAE,CAAG,CAAA,CAAA,CAAA;EAC1C,KAAC,CAAC,CACDF,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAA;EAE1B;EACAG,IAAAA,gBAAa,CAACZ,iBAAiB,EAAEQ,cAAc,EAAE,OAAO,CAAC,CAAA;EAEzDJ,IAAAA,OAAO,CAACC,GAAG,CACT,CAA4CL,yCAAAA,EAAAA,iBAAiB,EAAE,CAChE,CAAA;EACH,GAAA;;;;;;;;;"}