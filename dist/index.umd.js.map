{"version":3,"file":"index.umd.js","sources":["../src/index.ts"],"sourcesContent":["import { readFileSync, writeFileSync } from 'fs';\nimport * as path from 'path';\nimport { exec } from 'child_process';\n\nconst execPromise = (command) => {\n  return new Promise((resolve, reject) => {\n    exec(command, (error, stdout, stderr) => {\n      if (error) {\n        reject({ error, stderr, stdout });\n      } else {\n        resolve(stdout);\n      }\n    });\n  });\n};\n\nexport const meteorPackageTypesGenerator = {\n  run: async ({ tsInput, declarationInput, declarationOutput, prefix }) => {\n    try {\n      await execPromise(\n        `npx tsc ${tsInput.join(\n          ' '\n        )} --outFile ${declarationInput} --emitDeclarationOnly --declaration --declarationMap --skipDefaultLibCheck --target \"es2018\" --module \"nodenext\" --moduleResolution \"nodenext\" --esModuleInterop `\n      );\n    } catch (error) {\n      console.log(error?.stderr);\n      console.log(error?.stdout);\n      console.error(error?.error);\n    }\n\n    // Read the contents of the generated .d.ts file\n    const fileContent = readFileSync(declarationInput, 'utf-8');\n\n    // Add prefix to each module declaration\n    const updatedContent = fileContent\n      .replace(/declare module [\"'](.+?)[\"']/g, (match, p1) => {\n        return `declare module \"${prefix}${p1}\"`;\n      })\n      .replace(/\\/index/g, '');\n\n    // Write the updated content to a new file or overwrite the existing file\n    writeFileSync(declarationOutput, updatedContent, 'utf-8');\n\n    console.log(\n      `Prefixes added to modules and written to ${declarationOutput}`\n    );\n  },\n};\n\n"],"names":["execPromise","command","Promise","resolve","reject","exec","error","stdout","stderr","meteorPackageTypesGenerator","run","tsInput","declarationInput","declarationOutput","prefix","join","console","log","fileContent","readFileSync","updatedContent","replace","match","p1","writeFileSync"],"mappings":";;;;;EAIA,MAAMA,WAAW,GAAIC,OAAO,IAAI;EAC9B,EAAA,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrCC,kBAAI,CAACJ,OAAO,EAAE,CAACK,KAAK,EAAEC,MAAM,EAAEC,MAAM,KAAI;EACtC,MAAA,IAAIF,KAAK,EAAE;EACTF,QAAAA,MAAM,CAAC;YAAEE,KAAK;YAAEE,MAAM;EAAED,UAAAA,MAAAA;EAAQ,SAAA,CAAC,CAAA;EAClC,OAAA,MAAM;UACLJ,OAAO,CAACI,MAAM,CAAC,CAAA;EAChB,OAAA;EACH,KAAC,CAAC,CAAA;EACJ,GAAC,CAAC,CAAA;EACJ,CAAC,CAAA;AAEM,QAAME,2BAA2B,GAAG;IACzCC,GAAG,EAAE,OAAO;MAAEC,OAAO;MAAEC,gBAAgB;MAAEC,iBAAiB;EAAEC,IAAAA,MAAAA;EAAM,GAAE,KAAI;MACtE,IAAI;EACF,MAAA,MAAMd,WAAW,CACf,CAAWW,QAAAA,EAAAA,OAAO,CAACI,IAAI,CACrB,GAAG,CACJ,CAAA,WAAA,EAAcH,gBAAgB,CAAA,kKAAA,CAAoK,CACpM,CAAA;OACF,CAAC,OAAON,KAAK,EAAE;QACdU,OAAO,CAACC,GAAG,CAACX,KAAK,oBAALA,KAAK,CAAEE,MAAM,CAAC,CAAA;QAC1BQ,OAAO,CAACC,GAAG,CAACX,KAAK,oBAALA,KAAK,CAAEC,MAAM,CAAC,CAAA;QAC1BS,OAAO,CAACV,KAAK,CAACA,KAAK,oBAALA,KAAK,CAAEA,KAAK,CAAC,CAAA;EAC5B,KAAA;EAED;EACA,IAAA,MAAMY,WAAW,GAAGC,eAAY,CAACP,gBAAgB,EAAE,OAAO,CAAC,CAAA;EAE3D;EACA,IAAA,MAAMQ,cAAc,GAAGF,WAAW,CAC/BG,OAAO,CAAC,+BAA+B,EAAE,CAACC,KAAK,EAAEC,EAAE,KAAI;EACtD,MAAA,OAAO,CAAmBT,gBAAAA,EAAAA,MAAM,CAAGS,EAAAA,EAAE,CAAG,CAAA,CAAA,CAAA;EAC1C,KAAC,CAAC,CACDF,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAA;EAE1B;EACAG,IAAAA,gBAAa,CAACX,iBAAiB,EAAEO,cAAc,EAAE,OAAO,CAAC,CAAA;EAEzDJ,IAAAA,OAAO,CAACC,GAAG,CACT,CAA4CJ,yCAAAA,EAAAA,iBAAiB,EAAE,CAChE,CAAA;EACH,GAAA;;;;;;;;;"}